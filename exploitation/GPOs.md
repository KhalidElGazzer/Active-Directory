If we have some access Control Entries (ACEs) like **GenericWrite** over GPO, we could make our group is member of the administrator group of the target machine.<br>
we could reach to this machine via some recon using bloodhound:
![3a911e2876de1ee5cda169cd2089a0ce](https://github.com/user-attachments/assets/566284a2-c465-4e3b-9e5c-ff803067852b)
in the screen above we could see the ```svcservman``` account has GenericWrite permission over the "MANAGEMENT SERVER PUSHES" GPO, and this GPO is linked to "MANAGEMENT SERVERS" OU which contain THMSERVER2 machine.

First we need to inject AD user's creds into memory using ```runas``` command:
```         
C:\>runas /netonly /user:<DOmainName>\<AD Username> cmd.exe
```

Now we need to open MMC to modify the GPO:
```
C:\>mmc
```

We now want to add the Group Policy Management snap-in:

    Click File -> Add/Remove Snap-in
    Select the Group Policy Management snap-in and click Add
    Click Ok
    
  Then go to the vuln GPO and edit it.<br>
 In order to add our group which our account is member of to the administrators group, we need to perform the following steps:
 
    Expand Computer Configuration
    Expand Policies
    Expand Windows Settings
    Expand Security Settings
    Right Click on Restricted Groups and select Add Group
    Click Browse, enter our group(IT SUPPORT for example) and click Check Names
    Enter the Administrators in the second field
    Click OK


now our account which member of the added group became an administrator over the targer machine (which is THMSERVER2 in our example).
```
Restricted groups 
دي
 GPO
بتخلينا نضيف اي جروب لاي جروب تاني يعني مثلا لو عندنا جروب اسمه
it
 وعاوزين الجروب دا يبقي
 admins
 نعمله
GPO
ونحطه مع جروب ال
administrators

```








